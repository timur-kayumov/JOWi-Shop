Многоарендность и иерархия данных

SaaS-модель: Система разрабатывается как многоарендная (multi-tenant) SaaS-платформа. Один запущенный экземпляр сервиса обслуживает сразу несколько бизнесов (клиентов), изолируя их данные.

Изоляция данных: У каждой записи в БД (товар, чек, склад и т.д.) есть идентификатор арендатора (tenant_id), соответствующий конкретному бизнесу. Реализована Row-Level Security (RLS) на уровне PostgreSQL, чтобы гарантировать, что запросы пользователя возвращают только данные его компании.

Структура предприятия: Предусмотрена следующая иерархия сущностей:

Бизнес (компания) – основной арендатор. Например, юридическое лицо или индивидуальный предприниматель, владеющий сетью магазинов.

Магазин (торговая точка) – конкретная точка продаж/филиал компании. У бизнеса может быть множество магазинов (розничных точек).

Касса (терминал) – рабочее место кассира внутри магазина. Может соответствовать одному компьютеру с POS-приложением. В каждом магазине может быть несколько касс (если несколько кассиров работают параллельно).

Разграничение по магазину: Данные можно сегментировать по магазинам: складские остатки, продажи, кассовые смены привязаны к конкретному магазину. Пользователь с ролью, ограниченной магазином, видит только свой магазин. Управляющие или владельцы могут видеть данные по всем магазинам в бизнесе.

Единый аккаунт для нескольких бизнесов: (Опционально) В будущем, если один пользователь управляет несколькими бизнесами, можно предусмотреть переключение контекста арендатора после логина. Но в MVP достаточно поддержки одного бизнеса на учетную запись владельца